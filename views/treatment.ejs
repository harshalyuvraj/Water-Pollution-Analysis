<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Water Pollution Treatment Cost Calculator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Add your CSS styles here */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 10px;
        }
        
        header {
            background-color: #2F4F4F;
            color: white;
            padding: 20px 0;
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            margin: 0;
            font-size: 2.2em;
        }
        
        .subtitle {
            font-style: italic;
            opacity: 0.9;
            margin-top: 10px;
        }
        
        .calculator-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            padding: 25px;
            margin-bottom: 30px;
        }
        
        .calculator-title {
            color: #2F4F4F;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        
        .tab {
            padding: 12px 20px;
            cursor: pointer;
            background: #f1f1f1;
            
            margin-inline-start: auto;
            margin-inline-end: auto;
            border-radius: 5px 5px 0 0;
            transition: all 0.3s;
           

        }
        
        .tab:hover {
            background: #ddd;
        }
        
        .tab.active {
            background: #2F4F4F;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #2F4F4F;
        }
        
        input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        button {
            background-color: #20B2AA;
            color: white;
            border: none;
            padding: 12px 20px;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        button:hover {
            background-color: #1a7a74;
        }
        
        .results {
            margin-top: 30px;
            display: none;
        }
        
        .results-title {
            color: #2F4F4F;
            border-bottom: 2px solid #20B2AA;
            padding-bottom: 10px;
            margin-top: 30px;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 4px;
        }
        
        .result-label {
            font-weight: 600;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: #2F4F4F;
            color: white;
        }
        
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            margin: 30px 0;
        }
        
        .info-box {
            background: #f0f8ff;
            border-left: 4px solid #20B2AA;
            padding: 15px;
            margin-top: 30px;
        }
        
        .info-title {
            color: #2F4F4F;
            margin-top: 0;
        }
        
        footer {
            background-color: #2F4F4F;
            color: white;
            text-align: center;
            padding: 20px 0;
            margin-top: 50px;
        }
        
        
        /* Back button */
        .back-button-container {
            position: fixed;
            top: 30px;
            left: 30px;
            z-index: 100;
        }
        
        .back-button {
            background: linear-gradient(135deg,   #3a7d7d 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 50px;
            transition: all 0.4s cubic-bezier(0.165, 0.885, 0.32, 1.275);
            font-weight: 500;
            box-shadow: 0 4px 10px rgba(58, 97, 97, 0.3);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .back-button:hover {
            transform: translateX(-5px) scale(1.05);
            box-shadow: 0 8px 20px rgba(47, 79, 79, 0.4);
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header>
        <div class="container">
            <h1>Water Pollution Treatment Cost Calculator</h1>
            <div class="subtitle">Comprehensive cost analysis for wastewater and water treatment plants</div>
        </div>
    </header>

    <!-- Back to Home Button -->
    <div class="back-button-container">
        <button class="back-button" onclick="goBackHome()">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"/>
            </svg>
            Back to Home
        </button>
    </div>

    <div class="container">
        <div class="tabs">
            <div class="tab active" onclick="openTab('wastewater')">Wastewater Treatment</div>
            <div class="tab" onclick="openTab('water')">Water Treatment</div>
            <div class="tab" onclick="openTab('compare')">Compare Options</div>
        </div>

        <!-- Wastewater Treatment Calculator -->
        <div id="wastewater" class="tab-content active">
            <div class="calculator-card">
                <h2 class="calculator-title"><i class="fas fa-recycle"></i> Wastewater Treatment Plant Operating Costs</h2>
                <p>Based on research from "Investigation of Operating Costs at an Urban Wastewater Treatment Plant" (Altin et al., 2020)</p>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="population">Served Population</label>
                        <input type="number" id="population" value="108000">
                    </div>
                    
                    <div class="form-group">
                        <label for="flowRate">Daily Wastewater Flow Rate (m³/day)</label>
                        <input type="number" id="flowRate" value="34128">
                    </div>
                    
                    <div class="form-group">
                        <label for="cod">Average COD Concentration (mg/L)</label>
                        <input type="number" id="cod" value="400">
                    </div>
                    
                    <div class="form-group">
                        <label for="bod">Average BOD Concentration (mg/L)</label>
                        <input type="number" id="bod" value="230">
                    </div>
                    
                    <div class="form-group">
                        <label for="energyCost">Electricity Cost (₹/kWh)</label>
                        <input type="number" id="energyCost" step="0.01" value="8.50">
                    </div>
                    
                    <div class="form-group">
                        <label for="staffCost">Staff Cost per Person (₹/year)</label>
                        <input type="number" id="staffCost" step="1000" value="350000">
                    </div>
                </div>
                
                <button onclick="calculateWastewaterCosts()"><i class="fas fa-calculator"></i> Calculate Operating Costs</button>
                
                <div id="wastewaterResults" class="results">
                    <h3 class="results-title">Wastewater Treatment Cost Results</h3>
                    
                    <div class="result-item">
                        <span class="result-label">Annual Wastewater Volume:</span>
                        <span class="result-value" id="annualVolume"></span>
                    </div>
                    
                    <div class="result-item">
                        <span class="result-label">Total Annual Operating Cost:</span>
                        <span class="result-value" id="totalCost"></span>
                    </div>
                    
                    <h4>Cost Breakdown</h4>
                    <div class="chart-container">
                        <canvas id="wastewaterCostChart"></canvas>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Cost Component</th>
                                <th>Annual Cost</th>
                                <th>Percentage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Electricity</td>
                                <td id="electricityCost"></td>
                                <td id="electricityPercent"></td>
                            </tr>
                            <tr>
                                <td>Staff</td>
                                <td id="staffCostResult"></td>
                                <td id="staffPercent"></td>
                            </tr>
                            <tr>
                                <td>Maintenance & Repair</td>
                                <td id="maintenanceCost"></td>
                                <td id="maintenancePercent"></td>
                            </tr>
                            <tr>
                                <td>Chemicals</td>
                                <td id="chemicalCost"></td>
                                <td id="chemicalPercent"></td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <h4>Unit Costs</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Metric</th>
                                <th>Value</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Cost per m³ wastewater</td>
                                <td id="costPerCubicMeter"></td>
                            </tr>
                            <tr>
                                <td>Cost per person served</td>
                                <td id="costPerPerson"></td>
                            </tr>
                            <tr>
                                <td>Energy per m³ wastewater</td>
                                <td id="energyPerCubicMeter"></td>
                            </tr>
                            <tr>
                                <td>Energy per kg COD removed</td>
                                <td id="energyPerCOD"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="info-box">
                    <h4 class="info-title">About Wastewater Treatment Costs</h4>
                    <p>This calculator is based on research data from a medium-sized urban wastewater treatment plant. The cost breakdown follows the study findings where electricity and staff costs typically dominate the operating expenses.</p>
                    <p>Key benchmarks used:</p>
                    <ul>
                        <li>Energy consumption: 0.88 kWh/m³ of wastewater treated</li>
                        <li>COD removal energy: 2.22 kWh/kg COD</li>
                        <li>Typical cost distribution: Electricity (42%), Staff (46%), Maintenance (11%), Chemicals (1%)</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Water Treatment Calculator -->
        <div id="water" class="tab-content">
            <div class="calculator-card">
                <h2 class="calculator-title"><i class="fas fa-tint"></i> Water Treatment Cost Calculator</h2>
                <p>Calculate the costs for treating various water pollution parameters over a 20-year period.</p>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="capacity">Plant Capacity (MLD)</label>
                        <input type="number" id="capacity" placeholder="Enter capacity in MLD" value="10">
                    </div>
                    
                    <div class="form-group">
                        <label for="capitalCost">Capital Cost (₹ Crores)</label>
                        <input type="number" id="capitalCost" placeholder="Enter total capital cost" value="25">
                    </div>
                    
                    <div class="form-group">
                        <label for="ph">pH Correction Cost (₹ per m³)</label>
                        <input type="number" id="ph" placeholder="Enter cost per m³ for pH correction" value="0.50">
                    </div>
                    
                    <div class="form-group">
                        <label for="tds">TDS Removal Cost (₹ per m³)</label>
                        <input type="number" id="tds" placeholder="Enter cost per m³ for TDS removal" value="1.20">
                    </div>
                    
                    <div class="form-group">
                        <label for="bod">BOD Reduction Cost (₹ per m³)</label>
                        <input type="number" id="bod" placeholder="Enter cost per m³ for BOD reduction" value="1.50">
                    </div>
                    
                    <div class="form-group">
                        <label for="cod">COD Reduction Cost (₹ per m³)</label>
                        <input type="number" id="cod" placeholder="Enter cost per m³ for COD reduction" value="1.80">
                    </div>
                    
                    <div class="form-group">
                        <label for="turbidity">Turbidity Removal Cost (₹ per m³)</label>
                        <input type="number" id="turbidity" placeholder="Enter cost per m³ for turbidity removal" value="0.75">
                    </div>
                    
                    <div class="form-group">
                        <label for="operatingYears">Operating Years</label>
                        <input type="number" id="operatingYears" value="20" min="1">
                    </div>
                </div>
                
                <button onclick="calculateWaterCost()"><i class="fas fa-calculator"></i> Calculate Treatment Cost</button>
                
                <div id="waterResults" class="results">
                    <h3 class="results-title">Water Treatment Cost Results</h3>
                    
                    <div class="chart-container">
                        <canvas id="waterCostChart"></canvas>
                    </div>
                    
                    <div class="result-item">
                        <span class="result-label">Total Project Cost:</span>
                        <span class="result-value" id="totalProjectCost"></span>
                    </div>
                    
                    <div class="result-item">
                        <span class="result-label">Cost per m³ of Treated Water:</span>
                        <span class="result-value" id="costPerCubicMeterWater"></span>
                    </div>
                    
                    <div class="result-item">
                        <span class="result-label">Annual Treatment Volume:</span>
                        <span class="result-value" id="annualTreatmentVolume"></span>
                    </div>
                    
                    <h4>Cost Breakdown</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Cost Component</th>
                                <th>Total Cost</th>
                                <th>Percentage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Capital Cost</td>
                                <td id="capitalCostResult"></td>
                                <td id="capitalPercent"></td>
                            </tr>
                            <tr>
                                <td>pH Correction</td>
                                <td id="phCostResult"></td>
                                <td id="phPercent"></td>
                            </tr>
                            <tr>
                                <td>TDS Removal</td>
                                <td id="tdsCostResult"></td>
                                <td id="tdsPercent"></td>
                            </tr>
                            <tr>
                                <td>BOD Reduction</td>
                                <td id="bodCostResult"></td>
                                <td id="bodPercent"></td>
                            </tr>
                            <tr>
                                <td>COD Reduction</td>
                                <td id="codCostResult"></td>
                                <td id="codPercent"></td>
                            </tr>
                            <tr>
                                <td>Turbidity Removal</td>
                                <td id="turbidityCostResult"></td>
                                <td id="turbidityPercent"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="info-box">
                    <h4 class="info-title">About Water Treatment Costs</h4>
                    <p>This calculator estimates the total project cost over the specified period, including both capital expenditures and operational costs for water treatment processes.</p>
                    <p>The cost per cubic meter is calculated by dividing the total cost by the total volume treated over the operating period.</p>
                    <p>Typical water treatment costs vary based on:</p>
                    <ul>
                        <li>Plant size and capacity</li>
                        <li>Quality of source water</li>
                        <li>Treatment technologies employed</li>
                        <li>Local labor and energy costs</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Comparison Tab -->
        <div id="compare" class="tab-content">
            <div class="calculator-card">
                <h2 class="calculator-title"><i class="fas fa-balance-scale"></i> Cost Comparison</h2>
                <p>Compare the costs of different treatment options. Calculate both options first to enable comparison.</p>
                
                <div class="form-group">
                    <label for="exchangeRate">USD to INR Exchange Rate (for reference)</label>
                    <input type="number" id="exchangeRate" value="75" step="0.1">
                </div>
                
                <div id="comparisonResults" class="results">
                    <h3 class="results-title">Treatment Options Comparison (All values in ₹)</h3>
                    <div class="chart-container">
                        <canvas id="comparisonChart"></canvas>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Metric</th>
                                <th>Wastewater Treatment</th>
                                <th>Water Treatment</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Total Cost</td>
                                <td id="compareTotalWastewater"></td>
                                <td id="compareTotalWater"></td>
                            </tr>
                            <tr>
                                <td>Cost per m³</td>
                                <td id="comparePerM3Wastewater"></td>
                                <td id="comparePerM3Water"></td>
                            </tr>
                            <tr>
                                <td>Annual Volume</td>
                                <td id="compareVolumeWastewater"></td>
                                <td id="compareVolumeWater"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="info-box">
                    <h4 class="info-title">Comparison Notes</h4>
                    <p>This comparison helps evaluate the cost-effectiveness of different treatment approaches. Note that wastewater and water treatment serve different purposes:</p>
                    <ul>
                        <li><strong>Wastewater Treatment:</strong> Focuses on removing contaminants from used water before discharge or reuse</li>
                        <li><strong>Water Treatment:</strong> Focuses on making raw water suitable for consumption or industrial use</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>© 2025 Water Pollution Treatment Cost Calculator | Based on research by Altin et al. and industry benchmarks</p>
        </div>
    </footer>

    <script>
        // Global chart references
        let wastewaterChart = null;
        let waterChart = null;
        let comparisonChart = null;

        function goBackHome() {
            window.location.href = 'fwater';
        }

        // Tab functionality
        function openTab(tabName) {
            const tabs = document.getElementsByClassName('tab');
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove('active');
            }
            
            const tabContents = document.getElementsByClassName('tab-content');
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove('active');
            }
            
            document.getElementById(tabName).classList.add('active');
            event.currentTarget.classList.add('active');
            
            // Update comparison if we're on that tab
            if (tabName === 'compare') {
                updateComparison();
            }
        }
        
        // Wastewater treatment cost calculation (now in rupees)
        function calculateWastewaterCosts() {
            // Get input values
            const population = parseFloat(document.getElementById('population').value);
            const dailyFlow = parseFloat(document.getElementById('flowRate').value);
            const cod = parseFloat(document.getElementById('cod').value);
            const bod = parseFloat(document.getElementById('bod').value);
            const energyCost = parseFloat(document.getElementById('energyCost').value); // Now in ₹/kWh
            const staffCostPerPerson = parseFloat(document.getElementById('staffCost').value); // Now in ₹/year
            
            // Constants from research
            const energyPerCubicMeter = 0.88; // kWh/m³
            const electricityPercent = 0.42;
            const staffPercent = 0.46;
            const maintenancePercent = 0.11;
            const chemicalPercent = 0.01;
            
            // Calculations
            const annualVolume = dailyFlow * 365;
            const totalEnergy = annualVolume * energyPerCubicMeter;
            const electricityCostAnnual = totalEnergy * energyCost;
            
            // Calculate staff costs based on plant size (simplified)
            const staffCount = Math.max(5, Math.ceil(population / 20000)); // At least 5 staff
            const staffCostAnnual = staffCount * staffCostPerPerson;
            
            // Recalculate total cost based on actual staff costs
            const totalCostAnnual = electricityCostAnnual / electricityPercent;
            
            // Breakdown costs
            const maintenanceCostAnnual = totalCostAnnual * maintenancePercent;
            const chemicalCostAnnual = totalCostAnnual * chemicalPercent;
            
            // Unit costs
            const costPerCubicMeter = totalCostAnnual / annualVolume;
            const costPerPerson = totalCostAnnual / population;
            const energyPerCOD = 2.22; // kWh/kg COD from research
            
            // Display results (all in ₹)
            document.getElementById('annualVolume').textContent = annualVolume.toLocaleString() + ' m³';
            document.getElementById('totalCost').textContent = '₹' + (totalCostAnnual / 10000000).toLocaleString(undefined, {maximumFractionDigits: 2}) + ' crores';
            
            document.getElementById('electricityCost').textContent = '₹' + (electricityCostAnnual / 10000000).toLocaleString(undefined, {maximumFractionDigits: 2}) + ' crores';
            document.getElementById('electricityPercent').textContent = (electricityPercent * 100).toFixed(0) + '%';
            
            document.getElementById('staffCostResult').textContent = '₹' + (staffCostAnnual / 10000000).toLocaleString(undefined, {maximumFractionDigits: 2}) + ' crores';
            document.getElementById('staffPercent').textContent = (staffPercent * 100).toFixed(0) + '%';
            
            document.getElementById('maintenanceCost').textContent = '₹' + (maintenanceCostAnnual / 10000000).toLocaleString(undefined, {maximumFractionDigits: 2}) + ' crores';
            document.getElementById('maintenancePercent').textContent = (maintenancePercent * 100).toFixed(0) + '%';
            
            document.getElementById('chemicalCost').textContent = '₹' + (chemicalCostAnnual / 10000000).toLocaleString(undefined, {maximumFractionDigits: 2}) + ' crores';
            document.getElementById('chemicalPercent').textContent = (chemicalPercent * 100).toFixed(0) + '%';
            
            document.getElementById('costPerCubicMeter').textContent = '₹' + costPerCubicMeter.toFixed(2);
            document.getElementById('costPerPerson').textContent = '₹' + costPerPerson.toFixed(2);
            document.getElementById('energyPerCubicMeter').textContent = energyPerCubicMeter.toFixed(2) + ' kWh/m³';
            document.getElementById('energyPerCOD').textContent = energyPerCOD.toFixed(2) + ' kWh/kg COD';
            
            // Show results
            document.getElementById('wastewaterResults').style.display = 'block';
            
            // Create chart
            createWastewaterCostChart(electricityCostAnnual, staffCostAnnual, maintenanceCostAnnual, chemicalCostAnnual);
            
            // Store results for comparison
            localStorage.setItem('wastewaterResults', JSON.stringify({
                totalCost: totalCostAnnual,
                costPerM3: costPerCubicMeter,
                annualVolume: annualVolume
            }));
        }
        
        // Water treatment cost calculation (already in rupees)
        function calculateWaterCost() {
            let capacity = parseFloat(document.getElementById("capacity").value);
            let capitalCost = parseFloat(document.getElementById("capitalCost").value) * 10000000; // Convert crores to rupees
            let phCost = parseFloat(document.getElementById("ph").value);
            let tdsCost = parseFloat(document.getElementById("tds").value);
            let bodCost = parseFloat(document.getElementById("bod").value);
            let codCost = parseFloat(document.getElementById("cod").value);
            let turbidityCost = parseFloat(document.getElementById("turbidity").value);
            let operatingYears = parseFloat(document.getElementById("operatingYears").value);
            
            if (isNaN(capacity) || capacity <= 0) {
                alert("Please enter valid values for all fields.");
                return;
            }

            let dailyVolume = capacity * 1000; // Convert MLD to m³/day
            let annualVolume = dailyVolume * 365;
            let totalWaterVolume = annualVolume * operatingYears;
            
            // Calculate operational costs
            let totalPhCost = totalWaterVolume * phCost;
            let totalTdsCost = totalWaterVolume * tdsCost;
            let totalBodCost = totalWaterVolume * bodCost;
            let totalCodCost = totalWaterVolume * codCost;
            let totalTurbidityCost = totalWaterVolume * turbidityCost;
            
            let totalParameterCost = totalPhCost + totalTdsCost + totalBodCost + totalCodCost + totalTurbidityCost;
            let totalProjectCost = capitalCost + totalParameterCost;
            let costPerCubicMeter = totalProjectCost / totalWaterVolume;
            
            // Calculate percentages
            let capitalPercent = (capitalCost / totalProjectCost) * 100;
            let phPercent = (totalPhCost / totalProjectCost) * 100;
            let tdsPercent = (totalTdsCost / totalProjectCost) * 100;
            let bodPercent = (totalBodCost / totalProjectCost) * 100;
            let codPercent = (totalCodCost / totalProjectCost) * 100;
            let turbidityPercent = (totalTurbidityCost / totalProjectCost) * 100;
            
            // Display results
            document.getElementById("totalProjectCost").textContent = '₹' + (totalProjectCost / 10000000).toLocaleString(undefined, {maximumFractionDigits: 2}) + ' crores';
            document.getElementById("costPerCubicMeterWater").textContent = '₹' + costPerCubicMeter.toFixed(2);
            document.getElementById("annualTreatmentVolume").textContent = (annualVolume/1000000).toLocaleString() + ' million m³';
            
            document.getElementById("capitalCostResult").textContent = '₹' + (capitalCost / 10000000).toLocaleString(undefined, {maximumFractionDigits: 2}) + ' crores';
            document.getElementById("capitalPercent").textContent = capitalPercent.toFixed(1) + '%';
            
            document.getElementById("phCostResult").textContent = '₹' + (totalPhCost / 10000000).toLocaleString(undefined, {maximumFractionDigits: 2}) + ' crores';
            document.getElementById("phPercent").textContent = phPercent.toFixed(1) + '%';
            
            document.getElementById("tdsCostResult").textContent = '₹' + (totalTdsCost / 10000000).toLocaleString(undefined, {maximumFractionDigits: 2}) + ' crores';
            document.getElementById("tdsPercent").textContent = tdsPercent.toFixed(1) + '%';
            
            document.getElementById("bodCostResult").textContent = '₹' + (totalBodCost / 10000000).toLocaleString(undefined, {maximumFractionDigits: 2}) + ' crores';
            document.getElementById("bodPercent").textContent = bodPercent.toFixed(1) + '%';
            
            document.getElementById("codCostResult").textContent = '₹' + (totalCodCost / 10000000).toLocaleString(undefined, {maximumFractionDigits: 2}) + ' crores';
            document.getElementById("codPercent").textContent = codPercent.toFixed(1) + '%';
            
            document.getElementById("turbidityCostResult").textContent = '₹' + (totalTurbidityCost / 10000000).toLocaleString(undefined, {maximumFractionDigits: 2}) + ' crores';
            document.getElementById("turbidityPercent").textContent = turbidityPercent.toFixed(1) + '%';
            
            // Show results
            document.getElementById('waterResults').style.display = 'block';
            
            // Create chart
            createWaterCostChart(capitalCost, totalPhCost, totalTdsCost, totalBodCost, totalCodCost, totalTurbidityCost);
            
            // Store results for comparison
            localStorage.setItem('waterResults', JSON.stringify({
                totalCost: totalProjectCost,
                costPerM3: costPerCubicMeter,
                annualVolume: annualVolume
            }));
        }
        
        // Update comparison
        function updateComparison() {
            const wastewaterResults = JSON.parse(localStorage.getItem('wastewaterResults'));
            const waterResults = JSON.parse(localStorage.getItem('waterResults'));
            
            if (!wastewaterResults || !waterResults) {
                document.getElementById('comparisonResults').innerHTML = `
                    <h3 class="results-title">Treatment Options Comparison</h3>
                    <p>Please calculate both wastewater and water treatment costs first to enable comparison.</p>
                `;
                document.getElementById('comparisonResults').style.display = 'block';
                return;
            }
            
            // All values already in rupees
            document.getElementById('compareTotalWastewater').textContent = '₹' + (wastewaterResults.totalCost / 10000000).toLocaleString(undefined, {maximumFractionDigits: 2}) + ' crores';
            document.getElementById('compareTotalWater').textContent = '₹' + (waterResults.totalCost / 10000000).toLocaleString(undefined, {maximumFractionDigits: 2}) + ' crores';
            
            document.getElementById('comparePerM3Wastewater').textContent = '₹' + wastewaterResults.costPerM3.toFixed(2);
            document.getElementById('comparePerM3Water').textContent = '₹' + waterResults.costPerM3.toFixed(2);
            
            document.getElementById('compareVolumeWastewater').textContent = (wastewaterResults.annualVolume / 1000000).toLocaleString() + ' million m³';
            document.getElementById('compareVolumeWater').textContent = (waterResults.annualVolume / 1000000).toLocaleString() + ' million m³';
            
            document.getElementById('comparisonResults').style.display = 'block';
            
            // Create comparison chart
            createComparisonChart(wastewaterResults, waterResults);
        }
        
        // Chart creation functions
        function createWastewaterCostChart(electricity, staff, maintenance, chemicals) {
            const ctx = document.getElementById('wastewaterCostChart').getContext('2d');
            
            if (wastewaterChart) {
                wastewaterChart.destroy();
            }
            
            wastewaterChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Electricity', 'Staff', 'Maintenance', 'Chemicals'],
                    datasets: [{
                        data: [electricity, staff, maintenance, chemicals],
                        backgroundColor: [
                            '#20B2AA',
                            '#2F4F4F',
                            '#778899',
                            '#A9A9A9'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.raw || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = Math.round((value / total) * 100);
                                    return `${label}: ₹${(value / 10000000).toLocaleString(undefined, {maximumFractionDigits: 2})} crores (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function createWaterCostChart(capital, ph, tds, bod, cod, turbidity) {
            const ctx = document.getElementById('waterCostChart').getContext('2d');
            
            if (waterChart) {
                waterChart.destroy();
            }
            
            waterChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Capital Cost', 'pH Correction', 'TDS Removal', 'BOD Reduction', 'COD Reduction', 'Turbidity Removal'],
                    datasets: [{
                        data: [capital, ph, tds, bod, cod, turbidity],
                        backgroundColor: [
                            '#2F4F4F',
                            '#20B2AA',
                            '#3a5f5f',
                            '#778899',
                            '#5F9EA0',
                            '#A9A9A9'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.raw || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = Math.round((value / total) * 100);
                                    return `${label}: ₹${(value / 10000000).toLocaleString(undefined, {maximumFractionDigits: 2})} crores (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function createComparisonChart(wastewater, water) {
            const ctx = document.getElementById('comparisonChart').getContext('2d');
            
            if (comparisonChart) {
                comparisonChart.destroy();
            }
            
            comparisonChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Total Cost (₹ crores)', 'Cost per m³ (₹)', 'Annual Volume (million m³)'],
                    datasets: [
                        {
                            label: 'Wastewater Treatment',
                            data: [
                                wastewater.totalCost / 10000000,
                                wastewater.costPerM3,
                                wastewater.annualVolume / 1000000
                            ],
                            backgroundColor: '#20B2AA',
                            borderColor: '#1a7a74',
                            borderWidth: 1
                        },
                        {
                            label: 'Water Treatment',
                            data: [
                                water.totalCost / 10000000,
                                water.costPerM3,
                                water.annualVolume / 1000000
                            ],
                            backgroundColor: '#2F4F4F',
                            borderColor: '#1e3e3e',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Value'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    let value = context.raw;
                                    let suffix = '';
                                    
                                    if (context.dataIndex === 0) {
                                        suffix = ' crores';
                                        value = value.toLocaleString(undefined, {maximumFractionDigits: 2});
                                    } else if (context.dataIndex === 1) {
                                        suffix = ' ₹';
                                        value = value.toFixed(2);
                                    } else if (context.dataIndex === 2) {
                                        suffix = ' million m³';
                                        value = value.toLocaleString(undefined, {maximumFractionDigits: 2});
                                    }
                                    
                                    return `${label}: ${value}${suffix}`;
                                }
                            }
                        },
                        title: {
                            display: true,
                            text: 'Treatment Options Comparison (All values in ₹)',
                            font: {
                                size: 16
                            }
                        }
                    }
                }
            });
        }

        // Initialize with calculations
        window.onload = function() {
            calculateWastewaterCosts();
            calculateWaterCost();
            updateComparison();
        };
    </script>
</body>
</html>